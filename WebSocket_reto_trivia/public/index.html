<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Trivias en tiempo real</title>
    <link rel="stylesheet" href="styles.css">
    
  </head>
  <body>
    <h1>Trivia en Tiempo Real</h1>
    <!-- Formulario para ingresar el nombre -->
    <div id="nameBox">
      <input id="nameInput" placeholder="Tu nombre" />
      <button onclick="setName()">Entrar</button>
    </div>
    <!-- Contenedor del juego (se oculta hasta poner nombre) -->
    <div id="game" style="display: none">
      <div id="questionBox">
        <h2 id="question">Esperando la pregunta...</h2>
        <input id="answerInput" placeholder="Tu respuesta..." />
        <button onclick="sendAnswer()">Responder</button>
      </div>
      <div id="chat">
        <h3>Mensajes</h3>
        <div id="messages" style="height: 150px; overflow-y: auto"></div>
      </div>
      <div>
        <h3>Puntuaciones</h3>
        <ul id="players"></ul>
      </div>
    </div>
    <!-- Script de Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>

    <script>
      const socket = io(); // Conexión al servidor Socket.IO
      const messagesDiv = document.getElementById("messages");
      const playersList = document.getElementById("players");
      let playerName = "";
      // Función para establecer el nombre y entrar al juego
      function setName() {
        const name = document.getElementById("nameInput").value.trim();
        if (name) {
          playerName = name;
          socket.emit("setName", name); // Enviar nombre al servidor
          document.getElementById("nameBox").style.display = "none"; // Ocultar formulario
          document.getElementById("game").style.display = "block"; // Mostrar juego
        }
      }
      // Función para enviar una respuesta
      function sendAnswer() {
        const answer = document.getElementById("answerInput").value;
        socket.emit("answer", answer); // Enviar respuesta al servidor
        document.getElementById("answerInput").value = ""; // Limpiar input
      }
      // Escuchar mensajes generales del servidor
      socket.on("message", (msg) => {
        const p = document.createElement("p");
        p.textContent = msg;
        messagesDiv.appendChild(p);
        messagesDiv.scrollTop = messagesDiv.scrollHeight; // Auto-scroll
      });
      // Escuchar nuevas preguntas
      socket.on("question", (q) => {
        document.getElementById("question").textContent = q;
      });
      // Escuchar cambios en la lista de jugadores y sus puntajes
      socket.on("updatePlayers", (players) => {
        playersList.innerHTML = "";
        for (let id in players) {
          const li = document.createElement("li");
          li.textContent = `${players[id].name}: ${players[id].score} puntos`;
          playersList.appendChild(li);
        }
      });
    </script>
  </body>
</html>
